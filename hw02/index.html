<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>106820036 ct2022s 程式作業二</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="container">
        <div class="row mt-5 pt-3 border-bottom">
            <h1>ct2022s 程式作業二</h1>
            <h3 class="text-muted">106820036 蔣矩中</h3>
        </div>
        <div class="row pt-3 mt-1">
            <div id="face-select" class="row nowrap text-center">
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm ">BMP</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">SMP</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">SIP</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">TIP</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">4</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">5</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">6</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">7</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">8</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">9</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">10</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">11</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">12</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">13</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">SSP</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">PUA-A</button></div>
                <div class="col p-1"><button type="button" class="btn btn-outline-primary btn-sm">PUA-B</button></div>
            </div>

        </div>

        
        <div id="select" class="border">
        </div>



    </div>
    <div id="dialog" class="card border border-2 rounded hidden">
        <div class="card-body">
            This is some text within a card body.
        </div>
    </div>
</body>
<script>
    //setting btn color lol
    const faceSelectors = document.querySelectorAll("#face-select button");
    faceSelectors.forEach((e, i) => {
        e.style = `background-color:hsl(${360 * (i / 16)}, 100%, 50%);`
        e.onclick = function () { setMatrix(i) };
    })
    const mat = document.getElementById("select");
    const dialog = document.getElementById("dialog");
    let activeMat = -1
    function setMatrix(i) {
        activeMat = i;
        mat.style = `background: linear-gradient(306deg, hsl(${360 * (i / 16)}, 100%, 50%) 0%, hsl(${360 * (i / 16) + 90}, 100%, 50%) 50%, hsl(${360 * (i / 16) + 180}, 100%, 50%) 100%);`;
        mat.innerHTML = faceSelectors[i].innerHTML;
    }

    setMatrix(0);

    mat.addEventListener("mouseenter", ev => {
        console.log("enter")
        dialog.classList.toggle("hidden",false)
    });

    mat.addEventListener("mouseleave", ev => {
        console.log("leave")
        dialog.classList.toggle("hidden",true)
    });

    mat.addEventListener("mousemove", ev => {
        // console.log(ev.offsetX,ev.offsetY)
        if(ev.offsetX < 0 || ev.offsetY < 0) return;
        dialog.classList.toggle("hidden",false)
        dialog.style = `top: ${ev.pageY + 20}px; left: ${ev.pageX + 20}px;`
        let dec = Math.max((Math.floor((ev.offsetX * 256/mat.clientWidth) )) * Math.floor((ev.offsetY * 256 / mat.clientHeight) ) - 1 + 65535 * activeMat,0)
        let hex = dec.toString(16)
        while (hex.length < 6) hex = "0" + hex;
        dialog.firstElementChild.innerHTML = `0x${hex} ${String.fromCharCode(dec)}`
    });
</script>


</html>